@if (isViewingOwnProfile) {
  <div class="background" [ngStyle]="{'background-image': 'url(' + (currentUser.photoUrl) + '))'}">
    @if (currentUser$ | async; as currentUser) {
      <div class="profile">
        <img [src]="currentUser.photoUrl" alt="User Avatar" />
      </div>
      <div class="right">
        <div class="name">
          <h3>{{currentUser.name}}</h3>
          <p>{{currentUser.email}}</p>
          <p>{{followers.length}} Followers</p>
<!--          <button mat-flat-button (click)="followProfile()">Follow</button>-->
        </div>
      </div>
    }
  </div>
} @else {
  <div class="background" [ngStyle]="{'background-image': 'url(' + (viewedProfile.photoUrl) + '))'}">
    @if (viewedProfile$ | async; as viewedUser) {
      <div class="profile">
        <img [src]="viewedUser.photoUrl" alt="User Avatar" />
      </div>
      <div class="right">
        <div class="name">
          <h3>{{viewedUser.name}}</h3>
          <p>{{viewedUser.email}}</p>
          <p>{{followers.length}} Followers</p>
          <button mat-flat-button (click)="followProfile()">Follow</button>
        </div>
      </div>
    }
  </div>
}

<mat-tab-group>
  <mat-tab label="Uploaded">
    @for (track of uploadedTracks; track $index) {
      <app-music-tab [track]="track"></app-music-tab>
    }
  </mat-tab>

  <mat-tab label="Your Playlist">
    <div class="horizontal-scroll">
    @for (playlist of playlists; track playlist.id) {
      <div class="card" (click)="navigateToPlaylistDetail(playlist.id)">
        <img [src]="playlist.thumbnailPath"
             [alt]="playlist.title"
             width="100"
             height="96" />
        <div class="overlay">
        </div>
        <p class="label">{{ playlist.title }}</p>
        <p class="tracks">{{ getTrackCount(playlist.id) }} tracks</p>
      </div>
    }
    </div>
  </mat-tab>


  <mat-tab label="Favourite">
    @if (favoriteTracks) {
      @if (favoriteTracks.length > 0) {
        <mat-list>
          @for (track of favoriteTracks; track track.id) {
            <mat-list-item>
              <img
                [src]="track.thumbnailPath || 'assets/default-cover.png'"
                alt="{{ track.title }}"
                width="48"
                height="48"
                class="song-cover"
              />
              <div class="track-info">
                <span class="track-title">{{ track.title }}</span>
                <span class="track-artist">{{ track.artistName }}</span>
              </div>
            </mat-list-item>
          }
        </mat-list>
      } @else {
        <p class="empty">No favourite tracks yet üêæ</p>
      }
    }
  </mat-tab>

  <mat-tab label="History">
    @if (historyTracks$ | async; as history) {
      @if (history.length > 0) {
        <mat-list>
          @for (track of history; track track.id) {
            <mat-list-item>
              <img
                [src]="track.track.thumbnailPath | imgConverter"
                alt="{{ track.track.title}}"
                width="48"
                height="48"
                class="song-cover"
              />
              <div class="track-info">
                <span class="track-title">{{ track.track.title }}</span>
                <span class="track-artist">{{ track.track.artistName }}</span>
              </div>
            </mat-list-item>
          }
        </mat-list>
      } @else {
        <p class="empty">No history tracks yet üêæ</p>
      }
    }
  </mat-tab>

</mat-tab-group>
