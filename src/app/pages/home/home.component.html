@if ((isCategoriesLoading$ | async) ||
(isPlaylistsLoading$ | async) ||
(isProfilesLoading$ | async)) {
  <div class="loading-container">
    <mat-spinner></mat-spinner>
  </div>
} @else {
  <main>
    <section class="content-scroll" tabindex="0" aria-label="Main content">

      <!-- Music Genres -->
      <div>
        <h2 class="section-title">Music <span>Genres</span></h2>
        <div class="horizontal-scroll-wrapper">
          <div class="horizontal-scroll" #genresScroll aria-label="Music genres">
            @for (genre of categories$ | async; track genre.id) {
              <div class="card" (click)="navigateToCategoryDetail(genre.id)">
                <img
                  src="{{ genre.image }}"
                  alt="{{ genre.name }}"
                  width="100"
                  height="96"
                />
                <p class="label">{{ genre.name }}</p>
              </div>
            }
          </div>
        </div>
      </div>

      <!-- Mood Playlist -->
      <div>
        <h2 class="section-title">Mood <span>Playlist</span></h2>
        <div class="horizontal-scroll-wrapper">
          <div class="horizontal-scroll" #moodScroll aria-label="Mood playlists">

            <!-- Giữ phần moodPlaylists (đoạn 2) -->
            <div class="card" (click)="navigateToPlaylistDetail('new-released')">
              <img
                [src]="moodPlaylists[0].imageUrl"
                [alt]="moodPlaylists[0].name"
                width="100"
                height="96"
              />
              <p class="label">{{ moodPlaylists[0].name }}</p>
              <p class="tracks">{{ moodPlaylists[0].tracks }} tracks</p>
            </div>
            <div class="card" (click)="navigateToPlaylistDetail('popular')">
              <img
                [src]="moodPlaylists[1].imageUrl"
                [alt]="moodPlaylists[1].name"
                width="100"
                height="96"
              />
              <p class="label">{{ moodPlaylists[1].name }}</p>
              <p class="tracks">{{ moodPlaylists[1].tracks }} tracks</p>
            </div>
            @for (mood of moodPlaylists.slice(2); track $index) {
              <div class="card">
                <img
                  [src]="mood.imageUrl"
                  [alt]="mood.name"
                  width="100"
                  height="96"
                />
                <p class="label">{{ mood.name }}</p>
                <p class="tracks">{{ mood.tracks }} tracks</p>
              </div>
            }

            <!-- Giữ cả popularPlaylists-->
            @for (playlist of popularPlaylists; track $index) {
              <div class="card" (click)="navigateToPlaylistDetail(playlist.id)">
                <img
                  [src]="playlist.thumbnailPath"
                  [alt]="playlist.title"
                  width="100"
                  height="96"
                />
                <p class="label">{{ playlist.title }}</p>
                <p class="tracks">{{ playlist.trackCount }} tracks</p>
              </div>
            }
          </div>
        </div>
      </div>

      <!-- New Release Songs -->
      <section aria-labelledby="release-title">
        <h2 class="section-title">New Release <span>Songs</span></h2>
        @for (track of newReleaseTracks; track $index) {
          <app-music-tab [isFavorite]="track.isFavorite || false" [track]="track"></app-music-tab>
        }
      </section>

      <!-- Popular Artists -->
      <div>
        <h2 class="section-title">Popular <span>Artists</span></h2>
        <div class="horizontal-scroll-wrapper">
          <div class="popular-artists" #artistScroll aria-label="Popular artists">

            <!-- Tích hợp cả 2 nguồn dữ liệu -->
            @for (profile of popularProfiles; track $index) {
              <div class="artist">
                <img
                  [src]="profile.photoUrl"
                  [alt]="profile.name"
                  width="56"
                  height="56"
                />
                <p class="artist-name">{{ profile.name }}</p>
              </div>
            }

            @for (artist of popularArtists; track $index) {
              <div class="artist">
                <img
                  [src]="artist.imageUrl"
                  [alt]="artist.name"
                  width="56"
                  height="56"
                />
                <p class="artist-name">{{ artist.name }}</p>
              </div>
            }

          </div>
        </div>
      </div>

    </section>
  </main>
}
